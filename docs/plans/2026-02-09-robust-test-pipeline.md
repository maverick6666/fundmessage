# Robust Test Pipeline - 실사용 환경 오류탐색 자동화

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Docker 환경에서 모든 기능을 실제 사용자처럼 테스트하고, 엣지케이스/교차사용까지 검증하여 어떤 상황에서도 오류가 발생하지 않는 수준으로 만드는 것

**Architecture:** Docker Compose(DB + Backend + Frontend) 로컬 환경. Playwright MCP로 다중 브라우저/다중 계정 동시 테스트. 5단계 Deep Testing v2 프로토콜(기능+API+DB+UI시각+의미적 정합성). 미구현 기능은 구현 후 테스트. 버그 발견 즉시 수정→재테스트 루프.

**Tech Stack:** Docker Compose, Playwright MCP, FastAPI, React+Vite, PostgreSQL

---

## 1. 지시사항 (Claude 자동 행동 규칙)

### 1.1 문서 관리 규칙
- **이 문서가 유일한 계획 문서**. 다른 문서에 기록하지 않음
- 사용자가 개선점/추가 구현 사항을 말하면 → **즉시** 이 문서의 [사용자 입력 로그] 섹션에 기록
- 테스트 완료 후 → [테스트 진행 상황] 테이블 자동 업데이트
- 버그 수정 후 → [발견된 버그] 섹션에 기록 + 재테스트 결과 기록
- 기능 구현 완료 후 → [추가 구현 기능] 체크박스 업데이트

### 1.2 작업 규칙
- **프론트엔드 수정 시 반드시 `frontend-design` 스킬 호출** (직접 코드 수정 금지)
- 백엔드 수정은 직접 가능
- 코드 수정 후 Docker 재빌드: `docker-compose up -d --build`
- DB 스키마 변경 시: `docker exec fundmessage-backend alembic upgrade head`

### 1.3 테스트 규칙
- **물어보지 말고 자동으로 진행** - 사용자에게 확인/질문 없이 계속 진행
- **매 테스트마다 Playwright MCP로 실제 화면 스크린샷 필수** - UI 시각 검증용
- **매 테스트마다 5단계 Deep Testing v2 프로토콜 적용** (섹션 3 참조)
- 사이드뷰어는 페이지 이동 시 **닫히면 안 됨** (전역 상태, 열린 채로 유지)
- 다중 브라우저/다중 계정 동시 테스트로 WebSocket/실시간 알림 검증
- **안전한 테스트가 아닌 파괴적 테스트** - 실제 사용자가 이것저것 마구 건드리는 상황 재현
- 버그 발견 시 **즉시 수정 → 재테스트 반복** (나중에 수정 금지), 통과할 때까지 루프

### 1.4 세션 시작/종료 규칙
- **세션 시작 시**: 이 문서 읽기 → Docker 상태 확인 → 마지막 진행 지점부터 재개
- **세션 종료 시**: 진행 상황 업데이트 → 미완료 항목 표시 → git commit

### 1.5 프로세스 개선 규칙
- 테스트 중 발견한 프로세스/워크플로우 개선점은 **즉시 이 문서의 관련 섹션에 반영**
- 이 문서는 **살아있는 문서** - 계속 보완됨

---

## 2. Prerequisites (매 세션 시작 시 필수)

### Task 0.1: Docker 전체 스택 시작

**Step 1: Docker Desktop 실행 확인**

Run: `docker ps`

Expected: 에러 없이 컨테이너 목록 출력

**Step 2: 전체 스택 시작**

Run: `docker-compose up -d --build`

Expected:
- `fundmessage-db` Running
- `fundmessage-backend` Started
- `fundmessage-frontend` Started

**Step 3: 헬스체크**

Run: `curl http://localhost:8000/health`

Expected: `{"status":"healthy"}`

**Step 4: 프론트엔드 접속**

Playwright MCP로 `http://localhost` (포트 80) 접속

Expected: 로그인 페이지 표시

**Step 5: 테스트 계정 로그인 확인**

| 역할 | 이메일 | 비밀번호 | DB role |
|------|--------|----------|---------|
| 팀장 | lhhh0420@naver.com | lhh0420! | manager |
| 관리자 | admin@test.com | 12345678 | admin |
| 팀원 | test@naver.com | 12345678 | member |
| 일반 | viewer@test.com | 12345678 | viewer |

각 계정 로그인 → 스크린샷 → 권한별 UI 차이 확인

**모든 체크 통과해야 다음 단계 진행 가능**

---

## 3. Deep Testing v2 프로토콜

매 테스트에서 5단계 검증:

```
1. 기능 검증
   ✓ 버튼 클릭 → 예상 결과 발생하는가?
   ✓ 상태 변경이 즉시 UI에 반영되는가?

2. API 검증
   ✓ 네트워크 요청 성공 (2xx)?
   ✓ 응답 데이터 구조 정상?
   ✓ 4xx/5xx 에러 없는가?

3. DB 검증
   ✓ docker exec로 실제 DB 데이터 확인
   ✓ 데이터 정합성 (FK, 상태값 등)

4. UI 시각 검증
   ✓ 스크린샷으로 깨짐/겹침/잘림/빈화면 없는가?
   ✓ 다크모드에서도 가독성 확인
   ✓ 긴 텍스트/극단값 표시 정상?

5. 의미적 정합성 검증
   ✓ 표시된 내용이 맥락상 맞는가?
   ✓ 종료된 포지션에 "매수 중" 표시 = 실패
   ✓ 팀원에게 "승인" 버튼 표시 = 실패
   ✓ "undefined", "null", "NaN" 표시 = 실패
```

**다중 계정 동시 테스트:**
- 팀장/팀원 두 브라우저 동시 열기
- 한쪽 액션 → 다른 쪽 WebSocket/알림 수신 확인
- 권한별 UI 차이 동시 비교

---

## 4. 추가 구현 필요 기능

테스트 전에 구현해야 할 기능들. 구현 순서대로 나열.

### [IMP-001] 사이드뷰어 문서 댓글 기능
- [ ] 백엔드: Comment 모델 + API (CRUD)
- [ ] 프론트엔드: 사이드뷰어 하단 댓글 영역
- **대상**: 사이드뷰어로 열리는 모든 문서 (의사결정서, 운용보고서, 칼럼, AI칼럼, 뉴스)
- **권한**: 모든 권한(manager/admin/member/viewer) 댓글 작성 가능
- **표시**: 작성자명, 작성시간, 댓글 내용

**Files:**
- Create: `backend/app/models/comment.py`
- Create: `backend/app/schemas/comment.py`
- Create: `backend/app/api/comments.py`
- Modify: `backend/app/main.py` (라우터 등록)
- Create: `alembic revision` (comments 테이블)
- Modify: `frontend/src/components/layout/SidePanel.jsx` (댓글 영역 추가 - frontend-design 스킬)

### [IMP-002] viewer(일반) 권한 완성
- [ ] 프론트엔드: 모든 페이지에서 viewer 권한 체크
- [ ] 백엔드: 쓰기 API에 `get_writer_user` 의존성 추가
- **현재 상태**: 백엔드 `get_writer_user` 존재, 프론트엔드 2개 파일에만 viewer 참조
- **목표**: viewer는 댓글 외 모든 상호작용 불가 (보기 전용)
  - 매수/매도 요청 버튼 숨김
  - 승인/거부 버튼 숨김
  - 편집/삭제 버튼 숨김
  - 토론 메시지 전송 불가
  - 출석 체크인 불가
  - 칼럼 작성 불가
  - AI 생성 불가
  - **댓글만 가능**

**Files:**
- Modify: `backend/app/api/requests.py` (create_request에 get_writer_user)
- Modify: `backend/app/api/positions.py` (쓰기 엔드포인트)
- Modify: `backend/app/api/discussions.py` (메시지 전송)
- Modify: `backend/app/api/columns.py` (작성)
- Modify: `backend/app/api/attendance.py` (체크인)
- Modify: `backend/app/api/ai.py` (생성)
- Modify: 프론트엔드 전 페이지 (frontend-design 스킬)

### [IMP-003] 칼럼 검증 → 출석 연동
- [ ] 백엔드: 칼럼 검증 시 출석 복구/방패 로직
- [ ] 프론트엔드: 출석 방패 표시
- **로직**:
  1. 팀장이 칼럼 "검증됨" 클릭
  2. 작성자의 출석 기록 조회
  3. 미출석 있으면 → 가장 최근 미출석 1건을 출석으로 변경
  4. 출석률 100%면 → 출석 방패 +1 적립 (User 모델에 `attendance_shields` 필드 추가)
  5. 미출석 발생 시 → 방패 있으면 자동 소모하여 출석 유지

**Files:**
- Modify: `backend/app/models/user.py` (attendance_shields 필드)
- Modify: `backend/app/api/columns.py` (verify 엔드포인트에 출석 로직)
- Modify: `backend/app/services/attendance_service.py` (방패 소모 로직)
- Create: `alembic revision` (users.attendance_shields)

### [IMP-004] 뉴스데스크 AI칼럼/뉴스 분리
- [ ] 프론트엔드: AI칼럼 섹션 / 뉴스 섹션 분리
- **현재**: 같은 "오늘의 뉴스" 섹션에 AI칼럼과 뉴스 혼합
- **목표**: 별도 섹션으로 분리 표시

**Files:**
- Modify: `frontend/src/pages/NewsDesk.jsx` (frontend-design 스킬)

### [IMP-005] AI 생성 일일 제한 강화
- [ ] 백엔드: 팀별 일일 제한 카운트
- [ ] 프론트엔드: 잔여 횟수 표시 + 초과 시 비활성화
- **제한**:
  - 의사결정서 + 운용보고서: 팀별 하루 3회 (합산)
  - 뉴스데스크 생성: 팀별 하루 1회
  - KST 자정 리셋

**Files:**
- Modify: `backend/app/services/ai_service.py` (팀별 카운트)
- Modify: `backend/app/api/ai.py` (제한 체크)
- Modify: `backend/app/api/newsdesk.py` (생성 제한)

---

## 5. 기본 기능 테스트 시나리오 (A~O)

> 이전 테스트에서 통과한 시나리오 포함. 재검증 필요.

| ID | 시나리오 | 상태 | 비고 |
|----|----------|------|------|
| A1 | 회원가입 폼 | ⬜ | |
| A2 | 로그인 (4개 권한) | ⬜ | |
| A3 | 로그아웃 | ⬜ | |
| B1 | 대시보드 조회 | ⬜ | |
| B2 | 팀 정보 탭 | ⬜ | |
| B3 | 팀 설정 (팀장만) | ⬜ | |
| B4 | 환전 | ⬜ | |
| C1 | 포지션 목록 | ⬜ | |
| C2 | 포지션 요청 | ⬜ | |
| C3 | 포지션 상세 | ⬜ | |
| C4 | 포지션 정보 수정 | ⬜ | |
| C5 | 매매계획 관리 | ⬜ | |
| C6 | 의사결정노트 CRUD | ⬜ | |
| C7 | 포지션 종료 | ⬜ | |
| C8 | 토론 개시/요청 | ⬜ | |
| D1 | 요청 목록 | ⬜ | |
| D2 | 요청 승인 | ⬜ | |
| D3 | 요청 거부 | ⬜ | |
| D4 | 토론 개시 | ⬜ | |
| D5 | 토론 요청 (팀원) | ⬜ | |
| D6 | 요청 삭제 | ⬜ | |
| E1 | 토론 목록 | ⬜ | |
| E2 | 실시간 메시지 | ⬜ | 두 브라우저 동시 |
| E3 | 차트 공유 | ⬜ | |
| E4 | 토론 종료/재개 | ⬜ | |
| E5 | 토론 재개 요청 | ⬜ | |
| E6 | 세션 내보내기 | ⬜ | |
| F1 | 운용보고서 탭 | ⬜ | |
| F2 | 의사결정서 탭 | ⬜ | |
| F3 | 칼럼 탭 | ⬜ | |
| F4 | 칼럼 작성 | ⬜ | |
| F5 | 칼럼 검증 → 출석 연동 | ⬜ | IMP-003 구현 후 |
| F6 | 칼럼 삭제 | ⬜ | |
| F7 | 문서 댓글 작성/조회 | ⬜ | IMP-001 구현 후 |
| G1 | 팀 전체 통계 | ⬜ | |
| G2 | 내 성과 통계 | ⬜ | |
| H1 | 알림 조회 | ⬜ | |
| H2 | 알림 읽음 | ⬜ | |
| H3 | 알림 삭제 | ⬜ | |
| H4 | 실시간 알림 수신 | ⬜ | 두 브라우저 동시 |
| I1 | 팀원 목록 | ⬜ | |
| I2 | 팀원 승인 | ⬜ | |
| I3 | 역할 변경 | ⬜ | |
| I4 | 권한 이전 | ⬜ | |
| I5 | 계정 비활성화 | ⬜ | |
| J1 | 테마 변경 | ⬜ | |
| K1 | AI 의사결정서 (일일 제한) | ⬜ | IMP-005 구현 후 |
| K2 | AI 운용보고서 (일일 제한) | ⬜ | IMP-005 구현 후 |
| L1 | 출석 체크인 | ⬜ | |
| L2 | 출석 복구 (칼럼 검증) | ⬜ | IMP-003 구현 후 |
| L3 | 출석 방패 적립/소모 | ⬜ | IMP-003 구현 후 |
| M1 | 관리자 모드 토글 | ⬜ | |
| O1 | 뉴스데스크 조회 | ⬜ | |
| O2 | 날짜 선택기 | ⬜ | |
| O3 | 벤치마크 차트 | ⬜ | |
| O4 | 뉴스데스크 생성 (일일 1회) | ⬜ | IMP-005 구현 후 |
| O5 | 폴백 UI | ⬜ | |
| O6 | AI칼럼/뉴스 분리 표시 | ⬜ | IMP-004 구현 후 |
| O7 | 키워드 클라우드 | ⬜ | |
| P1 | viewer 전체 페이지 보기 전용 | ⬜ | IMP-002 구현 후 |

**상태**: ⬜ 미테스트 / ✅ 통과 / ❌ 실패 / 🔄 재테스트

---

## 6. 엣지케이스 테스트 시나리오 (96개)

### [EDGE-입력] 비정상 입력 (15개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| E-IN-01 | 매수 요청 금액 0원/음수/소수점 15자리 | ⬜ |
| E-IN-02 | 종목 검색에 SQL 인젝션 (`' OR 1=1 --`) | ⬜ |
| E-IN-03 | 종목 검색에 XSS (`<script>alert(1)</script>`) | ⬜ |
| E-IN-04 | 매매계획 익절가/손절가에 문자열/이모지 | ⬜ |
| E-IN-05 | 칼럼/댓글 빈 내용 제출 | ⬜ |
| E-IN-06 | 1만자 이상 초장문 텍스트 입력 | ⬜ |
| E-IN-07 | 이메일 필드에 이메일 아닌 값 | ⬜ |
| E-IN-08 | 비밀번호 1자리/공백만/특수문자만 | ⬜ |
| E-IN-09 | 매수 수량에 소수점 (주식은 정수만) | ⬜ |
| E-IN-10 | 환전 금액에 보유금 초과 입력 | ⬜ |
| E-IN-11 | 종목 검색 빈 문자열로 검색 | ⬜ |
| E-IN-12 | 팀 설정 초기자본금 0원/음수 | ⬜ |
| E-IN-13 | 토론방 메시지 공백만 전송 | ⬜ |
| E-IN-14 | 의사결정노트 제목 없이 저장 | ⬜ |
| E-IN-15 | 가격 알림 목표가에 비현실적 값 | ⬜ |

### [EDGE-흐름중단] 폼/모달 중 이탈 (15개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| E-FL-01 | 매수 요청 폼 작성 중 사이드바 클릭 | ⬜ |
| E-FL-02 | 승인 모달 열린 채 뒤로가기 | ⬜ |
| E-FL-03 | 로딩 중 같은 버튼 재클릭 | ⬜ |
| E-FL-04 | 포지션 종료 모달에서 뒤로가기 | ⬜ |
| E-FL-05 | 로그인 후 브라우저 뒤로가기 | ⬜ |
| E-FL-06 | 회원가입 중간에 로그인으로 이동 후 복귀 | ⬜ |
| E-FL-07 | 칼럼 작성 중 다른 탭 클릭 후 복귀 | ⬜ |
| E-FL-08 | 토론방 메시지 입력 중 토론 목록으로 이동 | ⬜ |
| E-FL-09 | AI 생성 요청 후 응답 전 페이지 이동 | ⬜ |
| E-FL-10 | 사이드뷰어 열린 상태에서 다른 페이지 이동 (뷰어 유지 확인) | ⬜ |
| E-FL-11 | 환전 모달 금액 입력 후 닫기 → 재오픈 시 초기화? | ⬜ |
| E-FL-12 | 포지션 정보 수정 중 새로고침 | ⬜ |
| E-FL-13 | 매매계획 수정 중 저장 안 하고 다른 포지션 클릭 | ⬜ |
| E-FL-14 | 다크모드 전환 중 페이지 이동 | ⬜ |
| E-FL-15 | 알림 패널 열린 채 다른 모달 오픈 | ⬜ |

### [EDGE-상태충돌] 무효 상태 조작 (15개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| E-ST-01 | 종료된 포지션 URL 직접 접근 후 수정 시도 | ⬜ |
| E-ST-02 | 삭제된 요청 URL 직접 접근 | ⬜ |
| E-ST-03 | 승인 버튼 더블클릭 (중복 포지션?) | ⬜ |
| E-ST-04 | 제출 버튼 연타 (중복 요청?) | ⬜ |
| E-ST-05 | 이미 처리된 요청 재승인/재거부 | ⬜ |
| E-ST-06 | 종료된 토론방에서 메시지 전송 시도 | ⬜ |
| E-ST-07 | 비활성화된 유저의 포지션/요청 접근 | ⬜ |
| E-ST-08 | 존재하지 않는 포지션 ID로 URL 접근 (/positions/99999) | ⬜ |
| E-ST-09 | 존재하지 않는 토론방 ID로 접근 | ⬜ |
| E-ST-10 | 포지션 종료 직후 매매계획 수정 시도 | ⬜ |
| E-ST-11 | 요청 승인 직후 같은 요청 새로고침 | ⬜ |
| E-ST-12 | 칼럼 삭제 직후 해당 칼럼 URL 접근 | ⬜ |
| E-ST-13 | 뉴스데스크 없는 날짜로 URL 접근 | ⬜ |
| E-ST-14 | 팀장이 자기 자신 비활성화 시도 | ⬜ |
| E-ST-15 | 팀장 위임 후 이전 팀장이 팀장 기능 시도 | ⬜ |

### [EDGE-권한/인증] 권한 우회 시도 (12개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| E-PM-01 | viewer가 API 직접 호출로 요청 제출 | ⬜ |
| E-PM-02 | member가 /team URL 직접 접근 | ⬜ |
| E-PM-03 | 비활성화 계정 로그인 시도 | ⬜ |
| E-PM-04 | 만료된 토큰으로 API 호출 | ⬜ |
| E-PM-05 | 리프레시 토큰 만료 후 자동 갱신 | ⬜ |
| E-PM-06 | viewer가 승인/거부 API 직접 호출 | ⬜ |
| E-PM-07 | member가 팀 설정 변경 API 직접 호출 | ⬜ |
| E-PM-08 | 로그아웃 후 뒤로가기로 보호 페이지 접근 | ⬜ |
| E-PM-09 | 다른 팀원의 의사결정노트 수정/삭제 시도 | ⬜ |
| E-PM-10 | viewer가 출석 체크인 API 호출 | ⬜ |
| E-PM-11 | 잘못된 JWT로 API 접근 | ⬜ |
| E-PM-12 | 두 브라우저에서 같은 계정 동시 로그인 | ⬜ |

### [EDGE-동시성/멀티유저] 다중 사용자 충돌 (8개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| E-MU-01 | 두 팀장이 같은 요청 동시 승인 | ⬜ |
| E-MU-02 | 팀장 승인과 팀원 요청 취소 동시 | ⬜ |
| E-MU-03 | 두 사용자가 같은 포지션 매매계획 동시 수정 | ⬜ |
| E-MU-04 | 토론방 양쪽 동시 메시지 전송 | ⬜ |
| E-MU-05 | 토론 종료 중 다른 쪽 메시지 전송 | ⬜ |
| E-MU-06 | 역할 변경 중 해당 유저 작업 중 | ⬜ |
| E-MU-07 | 뉴스데스크 생성 동시 요청 (1회 제한 우회?) | ⬜ |
| E-MU-08 | AI 생성 동시 요청 (3회 제한 우회?) | ⬜ |

### [EDGE-UI/시각] 화면 깨짐 (10개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| E-UI-01 | 모바일 뷰포트에서 모든 페이지 레이아웃 | ⬜ |
| E-UI-02 | 사이드뷰어 + 사이드바 동시 열림 시 메인 콘텐츠 | ⬜ |
| E-UI-03 | 긴 종목명/사용자명 카드/테이블 넘침 | ⬜ |
| E-UI-04 | 수익률 -999.99% 극단값 표시 | ⬜ |
| E-UI-05 | 빈 데이터 상태 (포지션 0개, 요청 0개) 각 페이지 | ⬜ |
| E-UI-06 | 다크모드에서 모든 모달/패널 가독성 | ⬜ |
| E-UI-07 | 긴 목록 스크롤 동작 | ⬜ |
| E-UI-08 | 토론방 메시지 100개 이상 스크롤 성능 | ⬜ |
| E-UI-09 | 차트 데이터 없을 때 차트 영역 표시 | ⬜ |
| E-UI-10 | 알림 뱃지 99+ 넘을 때 표시 | ⬜ |

### [EDGE-파일/업로드] 파일 처리 (4개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| E-FI-01 | 10MB 초과 이미지 업로드 | ⬜ |
| E-FI-02 | .exe/.js 비이미지 파일 업로드 | ⬜ |
| E-FI-03 | 깨진(corrupt) 이미지 파일 업로드 | ⬜ |
| E-FI-04 | 업로드 중 페이지 이동 | ⬜ |

### [EDGE-시간경계] KST 자정 전후 (3개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| E-TM-01 | KST 자정 직전 출석 → 다음날 출석 상태 | ⬜ |
| E-TM-02 | AI 일일 제한 3회 소진 후 자정 리셋 | ⬜ |
| E-TM-03 | 뉴스데스크 1회 소진 후 자정 리셋 | ⬜ |

### [EDGE-새로고침] 페이지 리로드 (3개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| E-RF-01 | 대시보드에서 F5 → 로그인 유지, 데이터 재로드 | ⬜ |
| E-RF-02 | 토론방에서 F5 → WebSocket 재연결, 메시지 유지 | ⬜ |
| E-RF-03 | 폼 제출 직후 F5 → 중복 제출 방지 | ⬜ |

### [EDGE-대량데이터] 성능/스크롤 (3개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| E-LD-01 | 포지션 50개 이상 목록 렌더링 | ⬜ |
| E-LD-02 | 토론방 메시지 200개 이상 스크롤 | ⬜ |
| E-LD-03 | 알림 100개 이상 목록 로딩 | ⬜ |

### [EDGE-에디터] 블록 에디터 (3개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| E-ED-01 | 칼럼 에디터에 리치텍스트 붙여넣기 | ⬜ |
| E-ED-02 | 에디터에 이미지 드래그앤드롭 | ⬜ |
| E-ED-03 | 에디터 내용 전체 삭제 후 저장 | ⬜ |

---

## 7. 교차 사용 테스트 시나리오 (20개)

### [CROSS-모달/패널 충돌] (5개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| X-MP-01 | 사이드뷰어 열린 채 다른 페이지 이동 → 뷰어 **유지** 확인 | ⬜ |
| X-MP-02 | 확인 모달 열린 상태에서 알림 클릭 | ⬜ |
| X-MP-03 | 환전 모달 열린 채 팀 설정 모달 오픈 시도 | ⬜ |
| X-MP-04 | 사이드뷰어 + 알림 패널 동시 열기 | ⬜ |
| X-MP-05 | AI 생성 로딩 모달 중 ESC/뒤로가기 | ⬜ |

### [CROSS-기능간 이동] (5개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| X-NV-01 | 포지션 상세 → 토론방 → 뒤로가기 → 포지션 상세 상태 유지 | ⬜ |
| X-NV-02 | 요청 승인 → 자동 생성 포지션 바로 접근 | ⬜ |
| X-NV-03 | 알림 클릭 → 해당 포지션/요청/토론으로 정확히 이동 | ⬜ |
| X-NV-04 | 통계 → 포지션 클릭 → 상세 → 뒤로가기 → 통계 탭 유지 | ⬜ |
| X-NV-05 | 뉴스데스크 → 칼럼 클릭 → 사이드뷰어 → 닫기 → 상태 유지 | ⬜ |

### [CROSS-멀티브라우저 실시간] (5개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| X-RT-01 | 팀원 매수 요청 → 팀장 실시간 알림 수신 | ⬜ |
| X-RT-02 | 팀장 승인 → 팀원 실시간 알림 수신 | ⬜ |
| X-RT-03 | 토론방 양쪽 동시 접속 → 메시지 실시간 교차 확인 | ⬜ |
| X-RT-04 | 팀장 포지션 종료 → 팀원 포지션 목록 갱신 | ⬜ |
| X-RT-05 | 칼럼 작성 → 다른 쪽 문서 탭 반영 | ⬜ |

### [CROSS-상태 전이 연쇄] (5개)

| ID | 시나리오 | 상태 |
|----|----------|------|
| X-ST-01 | 요청→승인→포지션→정보확인→매매계획→종료 (전체 플로우) | ⬜ |
| X-ST-02 | 요청→토론 개시→토론 종료→승인→포지션 (토론 경유) | ⬜ |
| X-ST-03 | 포지션 종료 → 관련 토론방 상태 변화 확인 | ⬜ |
| X-ST-04 | 칼럼 작성→검증→출석 복구/방패→출석률 변화 확인 | ⬜ |
| X-ST-05 | AI 의사결정서 생성→문서 탭 반영→사이드뷰어→댓글 작성 | ⬜ |

---

## 8. 테스트 진행 요약

| 카테고리 | 총 시나리오 | 통과 | 실패 | 미테스트 | 진행률 |
|----------|-------------|------|------|----------|--------|
| 기본 기능 (A~P) | 57 | 0 | 0 | 57 | 0% |
| 엣지케이스 | 96 | 0 | 0 | 96 | 0% |
| 교차 사용 | 20 | 0 | 0 | 20 | 0% |
| **합계** | **173** | **0** | **0** | **173** | **0%** |

---

## 9. 발견된 버그 및 수정 기록

> 버그 발견 시 여기에 기록. 수정 후 상태 업데이트.

| # | 시나리오 ID | 증상 | 원인 | 수정 | 상태 |
|---|------------|------|------|------|------|
| BUG-001 | B1 | 대시보드 칼럼 클릭 시 해당 칼럼 안보임 | onClick 이벤트 없음 | openDocument() 호출 추가 | ✅ 수정 |
| BUG-002 | C1 | 대시보드 프로그레스바 - 매매계획 없으면 비활성화해야 함 | 항상 표시됨 | hasTargets 체크 추가 | ✅ 수정 |
| BUG-003 | C1 | 대시보드 프로그레스바 - 포지션 상세와 연동 안됨 | 단순 profit_rate*5 계산 | calculateTargetProgress 사용 | ✅ 수정 |
| BUG-004 | D1 | 최근 요청 클릭 시 요청페이지로 이동 안됨 | onClick 이벤트 없음 | navigate() 호출 추가 | ✅ 수정 |
| BUG-005 | C1 | 프로그레스바 70%+ 그라데이션, 음수 빨간색 안됨 | 스타일 미적용 | isNearTarget 체크 + 그라데이션 CSS | ✅ 수정 |
| BUG-006 | C5 | 매매계획 체크 시 체크 활성화/평균매입가 변경 안됨 | 평균매입가 업데이트 로직 없음 | 매수 체결 시 가중평균 계산, 익절/손절 시 수량 차감 추가 | ✅ 수정 |
| BUG-007 | F7 | 문서/사이드뷰어 크기 고정 안됨 + 댓글 기능 없음 | 최소 너비 미설정 | minWidth 400px 설정 | 🔄 부분 수정 (댓글 미구현) |
| BUG-008 | F5 | 칼럼 검증 해제 기능 없음 | - | 이미 구현되어 있음 (확인) | ✅ 수정 완료 |
| BUG-009 | E-UI | 컴포넌트 최소 크기 미설정 - 텍스트 넘침 | CSS 미설정 | min-width, overflow 규칙 추가 | ✅ 수정 |
| BUG-010 | C3 | 트레이딩뷰 차트 최근 캔들 안보임 | rightOffset 없음 | timeScale rightOffset: 5 추가 | ✅ 수정 |
| BUG-011 | E2 | 토론방 차트공유 종목 검색 무한 로딩 | PyKRX 초기 로드 지연 | 백엔드 시작 시 캐싱 필요 | ⬜ 미수정 |

---

## 10. 사용자 입력 로그

> 사용자가 세션 중 말한 개선점/추가 구현 사항을 시간순으로 기록

| 날짜 | 입력 내용 | 반영 위치 | 상태 |
|------|----------|-----------|------|
| 2026-02-09 | 사이드뷰어 문서 댓글 기능 | IMP-001 | ⬜ 미구현 |
| 2026-02-09 | viewer 권한 완성 | IMP-002 | ⬜ 미구현 |
| 2026-02-09 | 칼럼 검증→출석 연동 (방패) | IMP-003 | ⬜ 미구현 |
| 2026-02-09 | 뉴스데스크 AI칼럼/뉴스 분리 | IMP-004 | ⬜ 미구현 |
| 2026-02-09 | AI 생성 일일 제한 강화 | IMP-005 | ⬜ 미구현 |
| 2026-02-09 | viewer는 댓글만 가능 | IMP-002에 포함 | ⬜ 미구현 |

---

## 11. 실행 순서

```
Phase 0: Prerequisites (Docker 시작, 계정 확인)
    ↓
Phase 1: 추가 기능 구현 (IMP-001 ~ IMP-005)
    ↓ (각 구현 후 관련 테스트)
Phase 2: 기본 기능 재검증 (A~P)
    ↓
Phase 3: 엣지케이스 테스트 (96개)
    ↓
Phase 4: 교차 사용 테스트 (20개)
    ↓
Phase 5: 전체 재검증 (실패 항목 재테스트)
    ↓
100% 통과 → 완료
```

**매 Phase에서 버그 발견 시:**
1. 이 문서에 버그 기록
2. 즉시 수정
3. 재테스트 통과 확인
4. 다음 시나리오로 진행

---

## 12. 완료 체크리스트

- [ ] Phase 0: Prerequisites 통과
- [ ] Phase 1: IMP-001~005 모두 구현
- [ ] Phase 2: 기본 기능 57개 전체 통과
- [ ] Phase 3: 엣지케이스 96개 전체 통과
- [ ] Phase 4: 교차 사용 20개 전체 통과
- [ ] Phase 5: 실패 항목 0개
- [ ] 모든 변경사항 git commit
- [ ] 173/173 시나리오 통과 (100%)
